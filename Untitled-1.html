<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>ğŸ° Thá» Kiá»ƒm Tra Giá»ng & VÄƒn Báº£n</title>

  <!-- ğŸŒ¸ â‘¡ PHáº¦N CSS: Trang trÃ­ & giao diá»‡n -->
  <style>
    /* Tá»•ng thá»ƒ */
    body {
      background: linear-gradient(135deg, #ffeef5, #ffd9e8); /* ná»n há»“ng pastel nháº¹ */
      font-family: "Poppins", sans-serif;
      text-align: center;
      padding: 30px;
      color: #333;
    }

    /* TiÃªu Ä‘á» chÃ­nh */
    h1 {
      font-size: 2rem;
      margin-bottom: 15px;
      color: #ff6f91;
      text-shadow: 1px 1px 2px rgba(255, 150, 180, 0.2);
    }

    /* NÃºt chá»n cháº¿ Ä‘á»™ */
    .mode-buttons {
      margin-bottom: 25px;
    }

    button {
      background: #ffb6c1;
      border: none;
      padding: 10px 20px;
      border-radius: 12px;
      margin: 5px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.25s ease;
      color: white;
      font-weight: 500;
      box-shadow: 0 4px 10px rgba(255, 182, 193, 0.4);
    }

    button:hover {
      background: #ffa1b0;
      transform: scale(1.05);
    }

    /* Khá»‘i giao diá»‡n chÃ­nh */
    .section {
      background: white;
      border-radius: 20px;
      padding: 25px;
      margin-top: 10px;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 0 15px rgba(255, 150, 180, 0.15);
      transition: all 0.3s ease;
    }

    .hidden {
      display: none;
    }

    /* Thanh tiáº¿n Ä‘á»™ */
    .progress-container {
      margin-top: 15px;
      background: #ffe6ec;
      border-radius: 10px;
      height: 8px;
      overflow: hidden;
    }

    .progress-bar {
      width: 0;
      height: 100%;
      background: linear-gradient(90deg, #ffb6c1, #ff91a4);
      transition: width 2s ease;
    }

    /* Ã” nháº­p vÄƒn báº£n */
    textarea {
      width: 90%;
      height: 100px;
      border-radius: 12px;
      border: 1px solid #ffd1dc;
      padding: 10px;
      font-size: 1rem;
      resize: none;
      outline: none;
      transition: box-shadow 0.2s ease;
    }

    textarea:focus {
      box-shadow: 0 0 5px #ffb6c1;
    }

    /* Khu vá»±c pháº£n há»“i */
    .feedback {
      margin-top: 15px;
      font-size: 1.1rem;
      color: #444;
      min-height: 30px;
    }

    /* Thá» hoáº¡t hÃ¬nh */
    .bunny {
      font-size: 3rem;
      animation: hop 1.2s infinite alternate ease-in-out;
    }

    @keyframes hop {
      0% { transform: translateY(0); }
      100% { transform: translateY(-10px); }
    }
  </style>
</head>

<body>

  <!-- ğŸŒ· â‘  PHáº¦N HTML: Cáº¥u trÃºc giao diá»‡n -->
  <h1>ğŸ‡ Thá» Kiá»ƒm Tra PhÃ¡t Ã‚m & Viáº¿t VÄƒn ğŸ‡</h1>

  <!-- NÃºt chá»n cháº¿ Ä‘á»™ -->
  <div class="mode-buttons">
    <button id="voiceMode">ğŸ¤ Cháº¿ Ä‘á»™ giá»ng nÃ³i</button>
    <button id="textMode">âœï¸ Cháº¿ Ä‘á»™ gÃµ vÄƒn báº£n</button>
  </div>

  <!-- Cháº¿ Ä‘á»™ GIá»ŒNG NÃ“I -->
  <div id="voiceSection" class="section">
    <div class="bunny">ğŸ°</div>
    <button id="startVoice">ğŸ™ï¸ Báº¯t Ä‘áº§u Ä‘á»c</button>
    <div id="voiceFeedback" class="feedback"></div>
    <div id="voiceProgressContainer" class="progress-container hidden">
      <div id="voiceProgressBar" class="progress-bar"></div>
    </div>
  </div>

  <!-- Cháº¿ Ä‘á»™ VÄ‚N Báº¢N -->
  <div id="textSection" class="section hidden">
    <div class="bunny">ğŸ°</div>
    <textarea id="textInput" placeholder="Nháº­p Ä‘oáº¡n vÄƒn cá»§a bÃ© vÃ o Ä‘Ã¢y nhÃ©..."></textarea>
    <br>
    <button id="checkText">ğŸ“– Kiá»ƒm tra</button>
    <div id="textFeedback" class="feedback"></div>
    <div id="textProgressContainer" class="progress-container hidden">
      <div id="textProgressBar" class="progress-bar"></div>
    </div>
  </div>


  <!-- ğŸª„ â‘¢ PHáº¦N JAVASCRIPT: Logic & pháº£n há»“i -->
  <script>
    // --- Pháº£n há»“i cho 2 cháº¿ Ä‘á»™ ---
    const voiceCompliments = [
      "BÃ© Ä‘á»c ráº¥t hay vÃ  rÃµ rÃ ng luÃ´n ğŸ‰",
      "Tá»‘t láº¯m! Giá»ng bÃ© dá»… thÆ°Æ¡ng ghÃª ğŸ˜„",
      "Chá»¯ nÃ o cÅ©ng rÃµ, bÃ© giá»i quÃ¡ ğŸ‘",
      "Cá»‘ lÃªn nha, bÃ© Ä‘á»c giá»i thÃªm tá»«ng ngÃ y ğŸŒŸ",
      "Ráº¥t tá»‘t, chá»‰ cáº§n cháº­m láº¡i má»™t chÃºt thÃ´i ğŸ¢",
      "Thá» ráº¥t tá»± hÃ o vá» bÃ© Ä‘Ã³ ğŸ°ğŸ’–",
      "BÃ© Ä‘á»c giá»i nhÆ° thá» nháº£y nhanh luÃ´n ğŸ¥•",
      "Tuyá»‡t vá»i! BÃ© khiáº¿n Thá» má»‰m cÆ°á»i rá»“i nÃ¨ ğŸ˜Š",
    ];

    const voiceCorrections = [
      "Thá»­ Ä‘á»c láº¡i nhÃ©, phÃ¡t Ã¢m chá»¯ 'ch' cho rÃµ hÆ¡n nha ğŸ‘‚",
      "CÃ³ vÃ i chá»— hÆ¡i nhanh, bÃ© cháº­m láº¡i má»™t chÃºt nÃ¨ â³",
      "Thiáº¿u dáº¥u nháº¹ thÃ´i, nhÆ°ng bÃ© lÃ m ráº¥t tá»‘t ğŸ’ª",
      "Cá»‘ gáº¯ng lÃªn, má»—i láº§n Ä‘á»c láº¡i lÃ  tiáº¿n bá»™ thÃªm ğŸ¯",
      "HÃ´m nay bÃ© Ä‘á»c 95% chÃ­nh xÃ¡c rá»“i Ä‘Ã³ ğŸ‡âœ¨",
      "Thá» nghe hÆ¡i láº«n chá»¯ 'r' vÃ  'd' Ä‘Ã³, thá»­ láº¡i nha ğŸ’¬",
      "BÃ© sáº¯p hoÃ n háº£o rá»“i, chá»‰ cáº§n chá»‰nh tÃ­ xÃ­u thÃ´i ğŸŒ¸",
    ];

    const textCompliments = [
      "BÃ© viáº¿t cÃ¢u ráº¥t máº¡ch láº¡c luÃ´n ğŸ“",
      "Diá»…n Ä‘áº¡t tá»‘t láº¯m, Ã½ rÃµ rÃ ng ghÃª ğŸ‘",
      "Tá»« ngá»¯ bÃ© chá»n ráº¥t hay ğŸŒ¸",
      "CÃ¢u vÄƒn tá»± nhiÃªn vÃ  dá»… hiá»ƒu láº¯m ğŸŒ¿",
      "Thá» thÃ­ch cÃ¡ch bÃ© viáº¿t nÃ¨ ğŸ°ğŸ’–",
      "Cáº¥u trÃºc cÃ¢u ráº¥t á»•n, bÃ© lÃ m tá»‘t Ä‘Ã³ ğŸ˜„",
      "BÃ© viáº¿t cÃ³ cáº£m xÃºc ghÃª Ä‘Ã³ âœ¨",
      "Äá»c Ä‘oáº¡n nÃ y mÃ  Thá» tháº¥y vui luÃ´n ğŸ’•",
    ];

    const textCorrections = [
      "Thá» tháº¥y cÃ³ vÃ i lá»—i chÃ­nh táº£ nhá», bÃ© thá»­ xem láº¡i nhÃ© âœï¸",
      "BÃ© thÃªm dáº¥u cÃ¢u sáº½ hay hÆ¡n Ä‘Ã³ ğŸ“š",
      "CÃ¢u hÆ¡i dÃ i chÃºt, chia nhá» sáº½ dá»… hiá»ƒu hÆ¡n nÃ¨ ğŸŒ¼",
      "Thá»­ dÃ¹ng thÃªm tá»« ná»‘i cho máº¡ch vÄƒn trÃ´i cháº£y hÆ¡n nha ğŸ’¬",
      "Ã bÃ© hay láº¯m, chá»‰ cáº§n chá»‰nh vÃ i chá»¯ thÃ´i ğŸ¯",
      "BÃ© Ä‘ang tiáº¿n bá»™ rÃµ luÃ´n, cá»‘ lÃªn nhÃ© ğŸ’ª",
    ];

    // --- Láº¥y pháº§n tá»­ DOM ---
    const voiceModeBtn = document.getElementById("voiceMode");
    const textModeBtn = document.getElementById("textMode");
    const voiceSection = document.getElementById("voiceSection");
    const textSection = document.getElementById("textSection");
    const startVoiceBtn = document.getElementById("startVoice");
    const checkTextBtn = document.getElementById("checkText");
    const voiceFeedback = document.getElementById("voiceFeedback");
    const textFeedback = document.getElementById("textFeedback");
    const textInput = document.getElementById("textInput");
    const voiceProgressContainer = document.getElementById("voiceProgressContainer");
    const textProgressContainer = document.getElementById("textProgressContainer");
    const voiceProgressBar = document.getElementById("voiceProgressBar");
    const textProgressBar = document.getElementById("textProgressBar");

    // --- Giá»ng ná»¯ tiáº¿ng Viá»‡t ---
    let vietnameseFemale = null;
    speechSynthesis.onvoiceschanged = () => {
      const voices = speechSynthesis.getVoices();
      vietnameseFemale = voices.find(
        (v) =>
          v.lang.startsWith("vi") &&
          (v.name.toLowerCase().includes("female") ||
           v.name.toLowerCase().includes("viet") ||
           v.name.toLowerCase().includes("google"))
      );
      console.log("ğŸ¤ ÄÃ£ táº£i giá»ng:", vietnameseFemale?.name || "KhÃ´ng tÃ¬m tháº¥y giá»ng Viá»‡t");
    };

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(
        text.replace(/[\p{Emoji_Presentation}\p{Extended_Pictographic}]/gu, "")
      );
      utter.lang = "vi-VN";
      utter.rate = 1.0;
      utter.pitch = 1.2;
      if (vietnameseFemale) utter.voice = vietnameseFemale;
      speechSynthesis.speak(utter);
    }

    // --- Chuyá»ƒn cháº¿ Ä‘á»™ ---
    voiceModeBtn.onclick = () => {
      voiceSection.classList.remove("hidden");
      textSection.classList.add("hidden");
      resetProgress();
    };
    textModeBtn.onclick = () => {
      textSection.classList.remove("hidden");
      voiceSection.classList.add("hidden");
      resetProgress();
    };

    // --- Hiá»ƒn thá»‹ thanh tiáº¿n Ä‘á»™ ---
    function showProgress(bar, container, callback) {
      container.classList.remove("hidden");
      bar.style.width = "0";
      setTimeout(() => (bar.style.width = "100%"), 100);
      setTimeout(() => {
        callback();
        bar.style.width = "0";
        container.classList.add("hidden");
      }, 2000);
    }

    function resetProgress() {
      voiceProgressContainer.classList.add("hidden");
      textProgressContainer.classList.add("hidden");
      voiceFeedback.textContent = "";
      textFeedback.textContent = "";
    }

    // --- Cháº¿ Ä‘á»™ GIá»ŒNG NÃ“I ---
    startVoiceBtn.onclick = () => {
      voiceFeedback.textContent = "ğŸ™ï¸ Thá» Ä‘ang láº¯ng nghe...";
      showProgress(voiceProgressBar, voiceProgressContainer, () => {
        const feedback =
          Math.random() > 0.5
            ? voiceCompliments[Math.floor(Math.random() * voiceCompliments.length)]
            : voiceCorrections[Math.floor(Math.random() * voiceCorrections.length)];
        voiceFeedback.textContent = feedback;
        speak(feedback);
      });
    };

    // --- Cháº¿ Ä‘á»™ GÃ• VÄ‚N Báº¢N ---
    checkTextBtn.onclick = () => {
      const text = textInput.value.trim();
      if (!text) {
        textFeedback.textContent = "BÃ© chÆ°a nháº­p gÃ¬ háº¿t nÃ¨ ğŸ§";
        speak("BÃ© chÆ°a nháº­p gÃ¬ háº¿t nÃ¨");
        return;
      }
      textFeedback.textContent = "ğŸ¤– Thá» Ä‘ang kiá»ƒm tra...";
      showProgress(textProgressBar, textProgressContainer, () => {
        const score = Math.floor(80 + Math.random() * 20);
        const feedback =
          (Math.random() > 0.5
            ? textCompliments[Math.floor(Math.random() * textCompliments.length)]
            : textCorrections[Math.floor(Math.random() * textCorrections.length)]) +
          ` BÃ© Ä‘áº¡t ${score}% chÃ­nh xÃ¡c Ä‘Ã³ ğŸ¯`;
        textFeedback.textContent = feedback;
        speak(feedback);
      });
    };
  </script>

</body>
</html>
